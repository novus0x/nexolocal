{% extends "layouts/dashboard.njk" %}

{% block title %}Platform Dashboard{% endblock %}

{% block content %}
{% include "components/dashboard-sidebar.njk" %}
{% include "components/dashboard-header.njk" %}
<main class="flex-1 overflow-y-auto p-6 lg:p-10">
    <div class="mb-8">
        <h2 class="text-3xl font-bold mb-2">Invitaciones</h2>
        <p class="text-gray-400 text-sm">Gestiona las solicitudes de acceso a organizaciones dentro de NexoLocal</p>
    </div>

    <div class="flex border-b border-[#30363D] mb-6" id="tabContainer">
        <button class="px-6 py-3 text-sm font-medium transition-all relative tab-active">
            Pendientes
            <span class="ml-2 px-1.5 py-0.5 rounded-full text-[10px] bg-(--accent)/20">{{ invitations_sidebar.quantity }}</span>
        </button>
        {# <button class="px-6 py-3 text-sm font-medium transition-all relative text-gray-500 hover:text-gray-300">
            Historial
        </button> #}
    </div>

    <div class="my-5 p-6 bg-[#0D1117] border border-[#30363D] rounded-2xl flex items-start gap-4">
        <div class="p-3 bg-(--accent)/10 rounded-xl">
            <i class="fas fa-shield-halved text-(--accent) text-xl"></i>
        </div>
        <div>
            <h4 class="font-bold text-sm text-white">Aviso de Seguridad</h4>
            <p class="text-xs text-gray-500 mt-1 leading-relaxed">
                Al aceptar una invitación, concedes a la empresa la capacidad de ver tu perfil público. Revisa siempre
                que la invitación provenga de una fuente confiable.
            </p>
        </div>
    </div>

    <div class="space-y-4">
        {% for invitation in invitations %}
        <div class="invitation-card bg-[#151B23] border border-[#30363D] rounded-xl overflow-hidden animate-fade-in">
            <div class="p-5 flex flex-col md:flex-row gap-5">
                <div class="shrink-0">
                    <div
                        class="w-14 h-14 flex items-center justify-center font-bold">
                        <img src="https://ui-avatars.com/api/?name={{ invitation.company_name }}&background=0D1117&color=FD420A" class="rounded-xl"
                            alt="Avatar">
                    </div>
                </div>

                <div class="grow">
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-lg font-bold">{{ invitation.company_name }}</h3>
                            <div class="flex items-center gap-2 text-sm text-gray-400 mt-1">
                                <i class="fas fa-id-badge text-(--accent)"></i>
                                <span class="text-gray-600">•</span>
                                <span>Invitado por <span class="capitalize">{{ invitation.inviter }}</span></span>
                            </div>
                        </div>
                        <div
                            class="text-[11px] text-gray-500 flex items-center gap-1 uppercase tracking-wider font-semibold">
                            <i class="fas fa-clock"></i>
                            {{ invitation.date }}
                        </div>
                    </div>
                    <div class="mt-4 flex flex-wrap gap-2">
                        {% for permission_invitation in invitation.permissions %}
                        <span
                            class="px-2 py-0.5 bg-[#0B0F14] border border-[#30363D] rounded-md text-[10px] text-gray-400">{{
                            permission_invitation }}</span>
                        {% endfor %}
                    </div>
                </div>

                <div
                    class="flex flex-row md:flex-col gap-2 justify-center md:border-l border-[#30363D] md:pl-5 min-w-35">

                    <a href="/invitations/accept/{{ invitation.id }}"
                        class="flex-1 btn-primary text-white py-2 px-4 rounded-lg text-sm font-bold flex items-center justify-center gap-2 cursor-pointer">
                        <i class="fas fa-check-circle"></i> Aceptar
                    </a>
                    <a href="/invitations/decline/{{ invitation.id }}"
                        class="flex-1 bg-[#21262D] hover:bg-[#30363D] text-gray-300 py-2 px-4 rounded-lg text-sm font-bold border border-[#30363D] flex items-center justify-center gap-2 cursor-pointer">
                        <i class="fas fa-times-circle"></i> Rechazar
                    </a>

                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</main>

{% include "components/dashboard-footer.njk" %}

{% endblock %}